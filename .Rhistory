group_by(registerwant_fac) %>%
summarize(cnt = n()) %>%
mutate(percentage = sprintf(cnt/sum(cnt)*100, fmt= "%#0.1f%%" )) #'%#.2f'
#check
registerwant_tab
#3.bar plot
registerwant_tab %>%
ggplot(aes(x =registerwant_fac , y=percentage)) +
geom_col(fill = "#003057", color ="#ffffff") +
theme_classic()+
labs(title = str_wrap("I was able to register for the course types that I wanted (on-campus, online, or flex)"))+
theme(plot.title = element_text(color = "#003057", size = 10, hjust = 0.5, face="bold"))+
labs(x = "", y = "")+
guides(y = "none")+
theme(axis.ticks = element_blank())+
geom_text(aes(label = percentage), vjust = 2, size = 3, color="#ffffff")
# save the plot
ggsave('registerwant21.jpg', width = 6, height = 6, path="pic")
df_sss21 %>% group_by (df_sss21[29]) %>% count()
df_sss21_full<-left_join(df_sss21,df_datamart21,by.x = "pc_id", by.y = "pc_id")
df_sss21_full
str(df_sss21_full)
col(df_sss21_full)
ncol(df_sss21_full)
ncol(df_sss21)
df_sss21_full<-left_join(df_sss21_full,df_reg21, by = "pc_id")
ncol(df_sss21_full)
ncol(df_sss21)
names(df_sss21_full)
setwd("~/Documents/Rprojects/student_satisfaction_survey")
list.files()
surveyQparts <- tribble(
~services, names(df_sss21_full)[2:16]
)
library(tibble)
surveyQparts <- tribble(
~services, names(df_sss21_full)[2:16]
)
#-------------------------data file prep-------------------------------------------------
#read data files, initial exploration
sss21<-read_excel("2021 SSS Raw.xlsx")
names(sss21)
#glimpse(sss21$`Invite Custom Field 1`)
#select (and rename) variables to build separate data frames
sss21.qual<-select(sss21, starts_with("Please explain"))
names(sss21.qual)
sss21.slct<-sss21 %>% select(`Invite Custom Field 1`, contains(":Please rate"))
names(sss21.slct) [1]<-"pc_id"
names(sss21.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss21.slct))
names(sss21.slct)
#revert to data frame to make variables and detect values for each variable
df_sss21<-as.data.frame(sss21.slct)
str(df_sss21)
names(df_sss21)
#-------------------------merge data-------------------------------
# read datamart data file and rename
datamart21<- read_excel("Datamart21Fall.xlsx")
names(datamart21)
df_datamart21 <- datamart21 %>% select (PC_ID, GENDER_CODE, ETHNICITY_REPORT_DESC, ADMIT_REGION, CITIZENSHIP, RESIDENT_YN, PARENTS_DEGREE, ADMIT_TYPE, TRANSFER_YN, COHORT, CLASS_LEVEL_RPT_LABEL, ACADEMIC_DEPT, CIP_CATEGORY, MAJOR_1, REG_PRIOR_CUM_GPA) %>% as.data.frame()
names(df_datamart21)<- tolower(names(df_datamart21))
# merge with data mart
df_sss21_full<-left_join(df_sss21,df_datamart21,by.x = "pc_id", by.y = "pc_id")
ncol(df_sss21_full)
ncol(df_sss21)
# read registar data file and rename
reg21<- read_excel("Registar21Fall.xlsx")
names(reg21)
df_reg21 <- reg21 %>% select (CumGPA, `FT/PT`, `People Code Id`) %>% as.data.frame()
names(df_reg21)[3] <- "pc_id"
names(df_reg21)<- tolower(names(df_reg21))
# merge with registar data
df_sss21_full<-left_join(df_sss21_full,df_reg21, by = "pc_id")
ncol(df_sss21_full)
ncol(df_sss21)
#load package
library(readxl) #for read_excel
library(readr) #for read_csv
library(dplyr) #for select, rename, join, etc.
library(tidyverse) #for pipes
library(ggplot2)
library(stringr)
#-------------------------data file prep-------------------------------------------------
#read data files, initial exploration
sss21<-read_excel("2021 SSS Raw.xlsx")
names(sss21)
#glimpse(sss21$`Invite Custom Field 1`)
#select (and rename) variables to build separate data frames
sss21.qual<-select(sss21, starts_with("Please explain"))
names(sss21.qual)
sss21.slct<-sss21 %>% select(`Invite Custom Field 1`, contains(":Please rate"))
names(sss21.slct) [1]<-"pc_id"
names(sss21.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss21.slct))
names(sss21.slct)
#revert to data frame to make variables and detect values for each variable
df_sss21<-as.data.frame(sss21.slct)
str(df_sss21)
names(df_sss21)
#-------------------------merge data-------------------------------
# read datamart data file and rename
datamart21<- read_excel("Datamart21Fall.xlsx")
names(datamart21)
df_datamart21 <- datamart21 %>% select (PC_ID, GENDER_CODE, ETHNICITY_REPORT_DESC, ADMIT_REGION, CITIZENSHIP, RESIDENT_YN, PARENTS_DEGREE, ADMIT_TYPE, TRANSFER_YN, COHORT, CLASS_LEVEL_RPT_LABEL, ACADEMIC_DEPT, CIP_CATEGORY, MAJOR_1, REG_PRIOR_CUM_GPA) %>% as.data.frame()
names(df_datamart21)<- tolower(names(df_datamart21))
# merge with data mart
df_sss21_full<-left_join(df_sss21,df_datamart21,by.x = "pc_id", by.y = "pc_id")
ncol(df_sss21_full)
ncol(df_sss21)
# read registar data file and rename
reg21<- read_excel("Registar21Fall.xlsx")
names(reg21)
df_reg21 <- reg21 %>% select (CumGPA, `FT/PT`, `People Code Id`) %>% as.data.frame()
names(df_reg21)[3] <- "pc_id"
names(df_reg21)<- tolower(names(df_reg21))
# merge with registar data
df_sss21_full<-left_join(df_sss21_full,df_reg21, by = "pc_id")
ncol(df_sss21_full)
ncol(df_sss21)
library(tibble)
surveyQparts <- tribble(
~services, names(df_sss21_full)[2:16]
)
surveyQparts
surveyQparts <- tribble(
~services, names(df_sss21_full)[2],names(df_sss21_full)[3],names(df_sss21_full)[4]
)
surveyQparts
library(treemapify)
library(scales)
ggplot(surveyQparts, aes(fill = services, label = paste(services))) +
geom_treemap() +
geom_treemap_text(color = "black",
place = "center", grow = F) +
scale_fill_brewer(palette = "Set3") +
labs(title = "Questions asked") +
theme(legend.position = "none",
plot.title = element_text(face = "bold"),
plot.caption = element_text(hjust = 0),
plot.title.position = "plot",
plot.caption.position = "plot")
library(treemapify)
library(scales)
install.packages("treemapify")
library(treemapify)
library(scales)
ggplot(surveyQparts, aes(fill = services, label = paste(services))) +
geom_treemap() +
geom_treemap_text(color = "black",
place = "center", grow = F) +
scale_fill_brewer(palette = "Set3") +
labs(title = "Questions asked") +
theme(legend.position = "none",
plot.title = element_text(face = "bold"),
plot.caption = element_text(hjust = 0),
plot.title.position = "plot",
plot.caption.position = "plot")
Treemap_tab <- tribble(~A, ~B, "name1", 1, "name2", 2)
library(treemapify)
library(scales)
ggplot(Treemap_tab, aes(area = B, fill = A, label = paste(A))) +
geom_treemap() +
geom_treemap_text(color = "black",
place = "center", grow = F) +
scale_fill_brewer(palette = "Set3") +
labs(title = "This is a treemap") +
theme(legend.position = "none",
plot.title = element_text(face = "bold"),
plot.caption = element_text(hjust = 0),
plot.title.position = "plot",
plot.caption.position = "plot")
#load package
library(readxl) #for read_excel
library(readr) #for read_csv
library(dplyr) #for select, rename, join, etc.
library(tidyverse) #for pipes
library(ggplot2)
library(stringr)
setwd("-/Documents/Rprojects/data/student_satisfaction_survey")
#-------------------------main data file prep-------------------------------------------------
#read data files, initial exploration
sss21<-read_excel("2021 SSS Raw.xlsx")
names(sss21)
#glimpse(sss21$`Invite Custom Field 1`)
#select (and rename) variables to build separate data frames
sss21.qual<-select(sss21, starts_with("Please explain"))
names(sss21.qual)
sss21.slct<-sss21 %>% select(`Invite Custom Field 1`, contains(":Please rate"))
names(sss21.slct) [1]<-"pc_id"
names(sss21.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss21.slct))
names(sss21.slct)
#revert to data frame to make variables and detect values for each variable
df_sss21<-as.data.frame(sss21.slct)
#load package
library(readxl) #for read_excel
library(readr) #for read_csv
library(dplyr) #for select, rename, join, etc.
library(tidyverse) #for pipes
library(ggplot2)
library(stringr)
setwd("-/Documents/Rprojects/data/student_satisfaction_survey")
#-------------------------main data file prep-------------------------------------------------
#read data files, initial exploration
sss21<-read_excel("2021 SSS Raw.xlsx")
names(sss21)
#glimpse(sss21$`Invite Custom Field 1`)
#select (and rename) variables to build separate data frames
sss21.qual<-select(sss21, starts_with("Please explain"))
names(sss21.qual)
sss21.slct<-sss21 %>% select(`Invite Custom Field 1`, contains(":Please rate"))
names(sss21.slct) [1]<-"pc_id"
names(sss21.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss21.slct))
names(sss21.slct)
#revert to data frame to make variables and detect values for each variable
df_sss21<-as.data.frame(sss21.slct)
setwd("-/Documents/Rprojects/data/student_satisfaction_survey")
getwd()
setwd("~/Documents/Rprojects/data/student_satisfaction_survey")
sss21<-read_excel("2021 SSS Raw.xlsx")
names(sss21)
#glimpse(sss21$`Invite Custom Field 1`)
#select (and rename) variables to build separate data frames
sss21.qual<-select(sss21, starts_with("Please explain"))
names(sss21.qual)
sss21.slct<-sss21 %>% select(`Invite Custom Field 1`, contains(":Please rate"))
names(sss21.slct) [1]<-"pc_id"
names(sss21.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss21.slct))
names(sss21.slct)
#revert to data frame to make variables and detect values for each variable
df_sss21<-as.data.frame(sss21.slct)
rm(sss21.slct)
rm(sss21)
View(sss21.qual)
View(df_sss21)
datamart21<- read_excel("Datamart21Fall.xlsx")
names(datamart21)
df_datamart21 <- datamart21 %>% select (PC_ID, GENDER_CODE, ETHNICITY_REPORT_DESC, ADMIT_REGION, CITIZENSHIP, RESIDENT_YN, PARENTS_DEGREE, ADMIT_TYPE, TRANSFER_YN, COHORT, CLASS_LEVEL_RPT_LABEL, ACADEMIC_DEPT, CIP_CATEGORY, MAJOR_1, REG_PRIOR_CUM_GPA) %>% as.data.frame()
names(df_datamart21)<- tolower(names(df_datamart21))
# merge with data mart
df_sss21_full<-left_join(df_sss21,df_datamart21,by.x = "pc_id", by.y = "pc_id")
ncol(df_sss21_full)
ncol(df_sss21)
# read registar data file and rename
reg21<- read_excel("Registar21Fall.xlsx")
names(reg21)
df_reg21 <- reg21 %>% select (CumGPA, `FT/PT`, `People Code Id`) %>% as.data.frame()
names(df_reg21)[3] <- "pc_id"
names(df_reg21)<- tolower(names(df_reg21))
# merge with registar data
df_sss21_full<-left_join(df_sss21_full,df_reg21, by = "pc_id")
ncol(df_sss21_full)
ncol(df_sss21)
rm(datamart21, df_datamart21, reg21, df_reg21, df_sss21)
View(df_sss21_full)
library("writexl")
write_xlsx(sss21_qual,"sss21_qual.xlsx")
write_xlsx(sss21.qual,"sss21_qual.xlsx")
list.files()
View(df_sss21_full)
#read data
sss17<-read_excel("2017SSSRaw.xlsx")
#check
names(sss17)
glimpse(sss17$`Invite Custom Field 1`)
#select variables
sss17.slct<-sss17 %>% select(`Invite Custom Field 1`, contains(":Please rate your level of "))
#rename variables
names(sss17.slct) [1]<-"pc_id"
names(sss17.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss17.slct))
names(sss17.slct)
#revert to data fram
df_sss17<-as.data.frame(sss17.slct)
#check
str(df_sss17)
sss17.slct2<-sss17.slct %>% select(match(names(df_sss21_full)))
names(sss17.slct2)
sss17.slct2<- select(names(sss17.slct), match(names(df_sss21_full)))
names(sss17.slct2)
sss17.slct2<- sss17.slct %>% select(match(names(sss17.slct), names(df_sss21_full)))
sss17.slct2<- sss17.slct %>% select(  names(sss17.slct) %in% names(df_sss21_full) )
names(sss17.slct) %in% names(df_sss21_full)
sss17.slct2<- sss17.slct %>% select_at(  names(sss17.slct) %in% names(df_sss21_full) )
sss17.slct2<- sss17.slct %>% select_if(  names(sss17.slct) %in% names(df_sss21_full) )
names(sss17.slct2)
#revert to data fram
df_sss17<-as.data.frame(sss17.slct2)
#check
str(df_sss17)
df_sss17 = df_sss17.add_suffix('_2017')
names(df_sss17)
colnames(df_sss17) <- paste(colnames(df_sss17), "2017", sep = "_")
names(df_sss17)
write_xlsx(df_sss21_full,"sss21_full.xlsx")
rm(sss17, sss17.slct, sss17.slct2)
sss18<-read_csv("2018SSSRaw.csv")
#check
names(sss18)
glimpse(sss18$`Invite Custom Field 1`)
sss18.slct<-sss18 %>% select(`Invite Custom Field 1`, contains(":Please rate"))
names(sss18.slct) [1]<-"pc_id"
names(sss18.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss18.slct))
names(sss18.slct)
sss18.slct2<- sss18.slct %>% select_if(  names(sss18.slct) %in% names(df_sss21_full) )
names(sss18.slct2)
df_sss18<-as.data.frame(sss18.slct2)
#check
str(df_sss18)
#read data
sss18<-read_csv("2018SSSRaw.csv")
#check
names(sss18)
glimpse(sss18$`Invite Custom Field 1`)
#select variables
sss18.slct<-sss18 %>% select(`Invite Custom Field 1`, contains(":Please rate"))
#rename variables
names(sss18.slct) [1]<-"pc_id"
names(sss18.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss18.slct))
#check
names(sss18.slct)
#select matched variables
sss18.slct2<- sss18.slct %>% select_if(  names(sss18.slct) %in% names(df_sss21_full) ) %>% as.data.frame()
names(sss18.slct2)
#add a suffix
colnames(sss18.slct2) <- paste(colnames(sss18.slct2), "2017", sep = "_")
names(sss18.slct2)
colnames(sss18.slct2) <- paste(colnames(sss18.slct2), "2018", sep = "_")
names(sss18.slct2)
sss18<-read_csv("2018SSSRaw.csv")
#check
names(sss18)
glimpse(sss18$`Invite Custom Field 1`)
#select variables
sss18.slct<-sss18 %>% select(`Invite Custom Field 1`, contains(":Please rate"))
#rename variables
names(sss18.slct) [1]<-"pc_id"
names(sss18.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss18.slct))
#check
names(sss18.slct)
#select matched variables
sss18.slct2<- sss18.slct %>% select_if(  names(sss18.slct) %in% names(df_sss21_full) ) %>% as.data.frame()
names(sss18.slct2)
#add a suffix
colnames(sss18.slct2) <- paste(colnames(sss18.slct2), "2018", sep = "_")
names(sss18.slct2)
rm(sss18, sss18.slct)
rm(sss18, sss18.slct, df_sss18)
#read data
sss17<-read_excel("2017SSSRaw.xlsx")
#check
names(sss17)
glimpse(sss17$`Invite Custom Field 1`)
#select variables
sss17.slct<-sss17 %>% select(`Invite Custom Field 1`, contains(":Please rate your level of "))
#rename variables
names(sss17.slct) [1]<-"pc_id"
names(sss17.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss17.slct))
names(sss17.slct)
#select matched variables
sss17.slct2<- sss17.slct %>% select_if(  names(sss17.slct) %in% names(df_sss21_full) ) %>% as.data.frame()
names(sss17.slct2)
#add a suffix
colnames(df_sss17) <- paste(colnames(df_sss17), "2017", sep = "_")
#check
names(df_sss17)
#remove unnecessary data
rm(df_sss17)
#read data
sss17<-read_excel("2017SSSRaw.xlsx")
#check
names(sss17)
glimpse(sss17$`Invite Custom Field 1`)
#select variables
sss17.slct<-sss17 %>% select(`Invite Custom Field 1`, contains(":Please rate your level of "))
#rename variables
names(sss17.slct) [1]<-"pc_id"
names(sss17.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss17.slct))
names(sss17.slct)
#select matched variables
sss17.slct2<- sss17.slct %>% select_if(  names(sss17.slct) %in% names(df_sss21_full) ) %>% as.data.frame()
names(sss17.slct2)
#add a suffix
colnames(sss17.slct2) <- paste(colnames(sss17.slct2), "2017", sep = "_")
#check
names(sss17.slct2)
#remove unnecessary data
rm(sss17,sss17.slct)
list.files()
#--------2019 data -----------
list.files()
#read data
sss19<-read_csv("2019SSSRaw.csv")
#check
names(sss19)
glimpse(sss19$`Invite Custom Field 1`)
#select variables
sss19.slct<-sss19 %>% select(`Invite Custom Field 1`, contains(":Please rate"))
#rename variables
names(sss19.slct) [1]<-"pc_id"
names(sss19.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss19.slct))
#check
names(sss19.slct)
#select matched variables
sss19.slct2<- sss19.slct %>% select_if(  names(sss19.slct) %in% names(df_sss21_full) ) %>% as.data.frame()
names(sss19.slct2)
#add a suffix
colnames(sss19.slct2) <- paste(colnames(sss19.slct2), "2018", sep = "_")
names(sss19.slct2)
#remove unnecessary data
rm(sss19, sss19.slct)
#--------2019 data -----------
list.files()
#read data
sss19<-read_csv("2019SSSRaw.csv")
#check
names(sss19)
glimpse(sss19$`Invite Custom Field 1`)
#select variables
sss19.slct<-sss19 %>% select(`Invite Custom Field 1`, contains(":Please rate"))
#rename variables
names(sss19.slct) [1]<-"pc_id"
names(sss19.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss19.slct))
#check
names(sss19.slct)
#select matched variables
sss19.slct2<- sss19.slct %>% select_if(  names(sss19.slct) %in% names(df_sss21_full) ) %>% as.data.frame()
names(sss19.slct2)
#add a suffix
colnames(sss19.slct2) <- paste(colnames(sss19.slct2), "2019", sep = "_")
names(sss19.slct2)
#remove unnecessary data
rm(sss19, sss19.slct)
list.files()
#--------2020 data -----------
list.files()
#read data
sss20<-read_csv("2020SSSRaw.csv")
#check
names(sss20)
glimpse(sss20$`Invite Custom Field 1`)
#select variables
sss20.slct<-sss20 %>% select(`Invite Custom Field 1`, contains(":Please rate"))
#rename variables
names(sss20.slct) [1]<-"pc_id"
names(sss20.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss20.slct))
#check
names(sss20.slct)
#select matched variables
sss20.slct2<- sss20.slct %>% select_if(  names(sss20.slct) %in% names(df_sss21_full) ) %>% as.data.frame()
names(sss20.slct2)
#add a suffix
colnames(sss20.slct2) <- paste(colnames(sss20.slct2), "2020", sep = "_")
names(sss20.slct2)
#remove unnecessary data
rm(sss20, sss20.slct)
rename(sss17.slct2$pc_id_2017=pc_id)
rename(sss17.slct2, pc_id_2017=pc_id)
name(sss17.slct2)[1]<- pc_id
name(sss17.slct2)[1] = pc_id
names(sss17.slct2)[1] = pc_id
rename(sss17.slct2, pc_id=pc_id_2017)
rename(sss18.slct2, pc_id=pc_id_2018)
rename(sss19.slct2, pc_id=pc_id_2019)
rename(sss20.slct2, pc_id=pc_id_2020)
sss_history<-full_join(sss17.slct2, sss18.slct2)
ncol(sss_history)
sss_history<-full_join(sss_history, sss19.slct2)
ncol(sss_history)
sss_history<-full_join(sss_history, sss20.slct2)
ncol(sss_history)
names(sss17.slct2)[1]
names(sss18.slct2)[1]
names(sss19.slct2)[1]
names(sss20.slct2)[1]
rename(sss17.slct2, pc_id = pc_id_2017)
rename(sss18.slct2, pc_id = pc_id_2018)
rename(sss19.slct2, pc_id = pc_id_2019)
rename(sss20.slct2, pc_id = pc_id_2020)
#check
names(sss17.slct2)[1]
names(sss18.slct2)[1]
names(sss19.slct2)[1]
names(sss20.slct2)[1]
sss17.slct2<- rename(sss17.slct2, pc_id = pc_id_2017)
sss18.slct2<- rename(sss18.slct2, pc_id = pc_id_2018)
sss19.slct2<- rename(sss19.slct2, pc_id = pc_id_2019)
sss20.slct2<- rename(sss20.slct2, pc_id = pc_id_2020)
#check
names(sss17.slct2)[1]
names(sss18.slct2)[1]
names(sss19.slct2)[1]
names(sss20.slct2)[1]
sss_history<-full_join(sss17.slct2, sss18.slct2, by=pc_id)
ncol(sss_history)
sss_history<-full_join(sss17.slct2, sss18.slct2, by="pc_id")
ncol(sss_history)
sss_history<-full_join(sss_history, sss19.slct2, by="pc_id")
ncol(sss_history)
sss_history<-full_join(sss_history, sss20.slct2, by="pc_id")
ncol(sss_history)
names(sss_history)
rm(sss20.slct2,sss19.slct2,sss18.slct2,sss17.slct2)
df_sss_history <- sss_history %>%
select(sort(current_vars()))
df_sss_history <- sss_history %>%
select(sort(tidyselect::peek_vars()))
names(df_sss_history)
rm(sss_history)
write_xlsx(df_sss_history,"sss17-20.xlsx")
write_xlsx(df_sss_history,"sss17-20_matched.xlsx")
rm("sss17-20.xlsx")
file.remove(df_sss_history,"sss17-20.xlsx")
list.files()
file.remove("sss17-20.xlsx")
list.files()
