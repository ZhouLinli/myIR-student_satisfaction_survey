sss21<-read_excel("2021 SSS Raw.xlsx")
names(sss21)
#glimpse(sss21$`Invite Custom Field 1`)
#select (and rename) variables to build separate data frames
#create the main data file (qualitative)
sss21.qual<-select(sss21, starts_with("Please explain"))
names(sss21.qual)
#select variables to create the main quantitative data file
sss21.slct<-sss21 %>% select(`Invite Custom Field 1`, contains(":Please rate"))
names(sss21.slct) [1]<-"pc_id"
names(sss21.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss21.slct))
names(sss21.slct)
#revert to data frame to make variables and detect values for each variable
df_sss21<-as.data.frame(sss21.slct)
str(df_sss21)
names(df_sss21)
rm(sss21.slct)
rm(sss21)
#======merge 2021 student background data========
#-----------datamart file-----------------------
#read file
datamart21<- read_excel("Datamart21Fall.xlsx")
names(datamart21)
#select variables
df_datamart21 <- datamart21 %>% select (PC_ID, GENDER_CODE, ETHNICITY_REPORT_DESC, ADMIT_REGION, CITIZENSHIP, RESIDENT_YN, PARENTS_DEGREE, ADMIT_TYPE, TRANSFER_YN, COHORT, CLASS_LEVEL_RPT_LABEL, ACADEMIC_DEPT, CIP_CATEGORY, MAJOR_1, REG_PRIOR_CUM_GPA) %>% as.data.frame() #check
names(df_datamart21)<- tolower(names(df_datamart21))
# merge with data mart
df_sss21_full<-left_join(df_sss21,df_datamart21,by.x = "pc_id", by.y = "pc_id")
#check
ncol(df_sss21_full)
ncol(df_sss21)
#--------------registar data-----------
#read data
reg21<- read_excel("Registar21Fall.xlsx")
names(reg21)
#select variables
df_reg21 <- reg21 %>% select (CumGPA, `FT/PT`, `People Code Id`) %>% as.data.frame()
names(df_reg21)[3] <- "pc_id"
names(df_reg21)<- tolower(names(df_reg21))
# merge with registar data
df_sss21_full<-left_join(df_sss21_full,df_reg21, by = "pc_id")
#check
ncol(df_sss21_full)
ncol(df_sss21)
#remove unnecessary objects
rm(datamart21, df_datamart21, reg21, df_reg21, df_sss21)
#setting up
setwd("~/Documents/Rprojects/data/student_satisfaction_survey")
getwd()
list.files()
options("digits" = 4)   # two decimal
#load package
library(readxl) #for read_excel
library(readr) #for read_csv
library(dplyr) #for select, rename, join, etc.
library(tidyverse) #for pipes
library(ggplot2)
#---------2017 data------------
#read data
sss17<-read_excel("2017SSSRaw.xlsx")
#check
names(sss17)
glimpse(sss17$`Invite Custom Field 1`)
#select variables
sss17.slct<-sss17 %>% select(`Invite Custom Field 1`, contains(":Please rate your level of "))
#rename variables
names(sss17.slct) [1]<-"pc_id"
names(sss17.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss17.slct))
names(sss17.slct)
#select matched variables
sss17.slct2<- sss17.slct %>% select_if(  names(sss17.slct) %in% names(df_sss21_full) ) %>% as.data.frame()
names(sss17.slct2)
#add a suffix
colnames(sss17.slct2) <- paste(colnames(sss17.slct2), "2017", sep = "_")
#check
names(sss17.slct2)
#remove unnecessary data
rm(sss17,sss17.slct)
#--------2018 data -----------
#read data
sss18<-read_csv("2018SSSRaw.csv")
#check
names(sss18)
glimpse(sss18$`Invite Custom Field 1`)
#select variables
sss18.slct<-sss18 %>% select(`Invite Custom Field 1`, contains(":Please rate"))
#rename variables
names(sss18.slct) [1]<-"pc_id"
names(sss18.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss18.slct))
#check
names(sss18.slct)
#select matched variables
sss18.slct2<- sss18.slct %>% select_if(  names(sss18.slct) %in% names(df_sss21_full) ) %>% as.data.frame()
names(sss18.slct2)
#add a suffix
colnames(sss18.slct2) <- paste(colnames(sss18.slct2), "2018", sep = "_")
names(sss18.slct2)
#remove unnecessary data
rm(sss18, sss18.slct)
#--------2019 data -----------
list.files()
#read data
sss19<-read_csv("2019SSSRaw.csv")
#check
names(sss19)
glimpse(sss19$`Invite Custom Field 1`)
#select variables
sss19.slct<-sss19 %>% select(`Invite Custom Field 1`, contains(":Please rate"))
#rename variables
names(sss19.slct) [1]<-"pc_id"
names(sss19.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss19.slct))
#check
names(sss19.slct)
#select matched variables
sss19.slct2<- sss19.slct %>% select_if(  names(sss19.slct) %in% names(df_sss21_full) ) %>% as.data.frame()
names(sss19.slct2)
#add a suffix
colnames(sss19.slct2) <- paste(colnames(sss19.slct2), "2019", sep = "_")
names(sss19.slct2)
#remove unnecessary data
rm(sss19, sss19.slct)
#--------2020 data -----------
list.files()
#read data
sss20<-read_csv("2020SSSRaw.csv")
#check
names(sss20)
glimpse(sss20$`Invite Custom Field 1`)
#select variables
sss20.slct<-sss20 %>% select(`Invite Custom Field 1`, contains(":Please rate"))
#rename variables
names(sss20.slct) [1]<-"pc_id"
names(sss20.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss20.slct))
#check
names(sss20.slct)
#select matched variables
sss20.slct2<- sss20.slct %>% select_if(  names(sss20.slct) %in% names(df_sss21_full) ) %>% as.data.frame()
names(sss20.slct2)
#add a suffix
colnames(sss20.slct2) <- paste(colnames(sss20.slct2), "2020", sep = "_")
names(sss20.slct2)
#remove unnecessary data
rm(sss20, sss20.slct)
View(sss17.slct2)
View(sss18.slct2)
View(sss19.slct2)
View(sss20.slct2)
#===========merging==============
#prepare the primary key
sss17.slct2<- rename(sss17.slct2, pc_id = pc_id_2017)
sss18.slct2<- rename(sss18.slct2, pc_id = pc_id_2018)
sss19.slct2<- rename(sss19.slct2, pc_id = pc_id_2019)
sss20.slct2<- rename(sss20.slct2, pc_id = pc_id_2020)
View(sss17.slct2)
View(sss18.slct2)
View(sss19.slct2)
View(sss20.slct2)
#--------2018 data -----------
#read data
sss18<-read_csv("2018SSSRaw.csv")
#check
names(sss18)
glimpse(sss18$`Invite Custom Field 1`)
#select variables
sss18.slct<-sss18 %>% select(`Invite Custom Field 1`, contains(":Please rate"))
#rename variables
names(sss18.slct) [1]<-"pc_id"
names(sss18.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss18.slct))
#check
names(sss18.slct)
#select matched variables
sss18.slct2<- sss18.slct %>% select_if(  names(sss18.slct) %in% names(df_sss21_full) ) %>% as.data.frame()
names(sss18.slct2)
#add a suffix
colnames(sss18.slct2) <- paste(colnames(sss18.slct2), "2018", sep = "_")
names(sss18.slct2)
#remove unnecessary data
rm(sss18, sss18.slct)
View(sss18.slct2)
#read data
sss18<-read_csv("2018SSSRaw.csv")
#check
names(sss18)
glimpse(sss18$`Invite Custom Field 1`)
View(sss18)
#------------load package--------------
library(readxl) #for read_excel
library(readr) #for read_csv
library(dplyr) #for select, rename, join, etc.
library(tidyverse) #for pipes
library(ggplot2) #for making charts
library(stringr)  #for working with strings/texts/qualitative data
library("writexl")#for save data frame as excel files
#------working directory --------
getwd()
setwd("-/Documents/Rprojects/data/student_satisfaction_survey")
#============data files ===========
#------main data file--------------
#read data files, initial exploration
sss21<-read_excel("2021 SSS Raw.xlsx")
names(sss21)
#glimpse(sss21$`Invite Custom Field 1`)
#select (and rename) variables to build separate data frames
#create the main data file (qualitative)
sss21.qual<-select(sss21, starts_with("Please explain"))
names(sss21.qual)
#select variables to create the main quantitative data file
sss21.slct<-sss21 %>% select(`Invite Custom Field 1`, contains(":Please rate"))
names(sss21.slct) [1]<-"pc_id"
names(sss21.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss21.slct))
names(sss21.slct)
#revert to data frame to make variables and detect values for each variable
df_sss21<-as.data.frame(sss21.slct)
str(df_sss21)
names(df_sss21)
rm(sss21.slct)
rm(sss21)
#======merge 2021 student background data========
#-----------datamart file-----------------------
#read file
datamart21<- read_excel("Datamart21Fall.xlsx")
names(datamart21)
#select variables
df_datamart21 <- datamart21 %>% select (PC_ID, GENDER_CODE, ETHNICITY_REPORT_DESC, ADMIT_REGION, CITIZENSHIP, RESIDENT_YN, PARENTS_DEGREE, ADMIT_TYPE, TRANSFER_YN, COHORT, CLASS_LEVEL_RPT_LABEL, ACADEMIC_DEPT, CIP_CATEGORY, MAJOR_1, REG_PRIOR_CUM_GPA) %>% as.data.frame() #check
names(df_datamart21)<- tolower(names(df_datamart21))
# merge with data mart
df_sss21_full<-left_join(df_sss21,df_datamart21,by.x = "pc_id", by.y = "pc_id")
#check
ncol(df_sss21_full)
ncol(df_sss21)
#--------------registar data-----------
#read data
reg21<- read_excel("Registar21Fall.xlsx")
names(reg21)
#select variables
df_reg21 <- reg21 %>% select (CumGPA, `FT/PT`, `People Code Id`) %>% as.data.frame()
names(df_reg21)[3] <- "pc_id"
names(df_reg21)<- tolower(names(df_reg21))
# merge with registar data
df_sss21_full<-left_join(df_sss21_full,df_reg21, by = "pc_id")
#check
ncol(df_sss21_full)
ncol(df_sss21)
#remove unnecessary objects
rm(datamart21, df_datamart21, reg21, df_reg21, df_sss21)
#========merge historical data========
setwd("~/Documents/Rprojects/student_satisfaction_survey")
list.files()
source("sss_17-20_matched.R")  #run code from saved r script
require(openxlsx)
list_of_datasets <- list("data_21quan" = df_sss21_full, "data_21qual" = sss21.qual, "data_17"=sss17.slct2, "data_18"=sss18.slct2, "data_19"=sss19.slct2, "data_20"=sss20.slct2)
write.xlsx(list_of_datasets, file = "fulldata.xlsx")
#check
list.files()
read_excel("fulldata.xlsx")
read_excel("fulldata.xlsx", sheet = "data_21quan")
read_excel("fulldata.xlsx", sheet = "data_21qual")
read_excel("fulldata.xlsx", sheet = "data_17")
read_excel("fulldata.xlsx", sheet = "data_18")
read_excel("fulldata.xlsx", sheet = "data_19")
read_excel("fulldata.xlsx", sheet = "data_20")
#------------load package--------------
library(readxl) #for read_excel
library(readr) #for read_csv
library(dplyr) #for select, rename, join, etc.
library(tidyverse) #for pipes
library(ggplot2) #for making charts
library(stringr)  #for working with strings/texts/qualitative data
library("writexl")#for save data frame as excel files
#------working directory --------
getwd()
setwd("-/Documents/Rprojects/data/student_satisfaction_survey")
#============data files ===========
#------main data file--------------
#read data files, initial exploration
sss21<-read_excel("2021 SSS Raw.xlsx")
names(sss21)
sss21.qual<-select(sss21, starts_with("Please explain"), starts_with("Please provide explanations"), starts_with("Please provide any additional details"))
sss21.qual<-select(sss21, starts_with("Please explain", "Please provide explanations", "Please provide any additional details"))
sss21.qual<-select(sss21, starts_with("Please explain"), starts_with("Please provide explanations"), starts_with("Please provide any additional details"), names(sss21)[153])
sss21.slct<-sss21 %>% select(`Invite Custom Field 1`,  `Which of the following describes your status for the 2021 fall semester?`, contains(":Please rate"), contains(":Â Please rate"), contains(":If it applies to you, please rate"), contains(":Â   Please estimate"), names(sss21)[138:152])
#------------load package--------------
library(readxl) #for read_excel
library(readr) #for read_csv
library(dplyr) #for select, rename, join, etc.
library(tidyverse) #for pipes
library(ggplot2) #for making charts
library(stringr)  #for working with strings/texts/qualitative data
library("writexl")#for save data frame as excel files
#------working directory --------
getwd()
setwd("-/Documents/Rprojects/data/student_satisfaction_survey")
#============data files ===========
#------main data file--------------
#read data files, initial exploration
sss21<-read_excel("2021 SSS Raw.xlsx")
names(sss21)
#glimpse(sss21$`Invite Custom Field 1`)
#select (and rename) variables to build separate data frames
#create the main data file (qualitative)
sss21.qual<-select(sss21, starts_with("Please explain"), starts_with("Please provide explanations"), starts_with("Please provide any additional details"), names(sss21)[153])
names(sss21.qual)
#select variables to create the main quantitative data file
sss21.slct<-sss21 %>% select(`Invite Custom Field 1`,  `Which of the following describes your status for the 2021 fall semester?`, contains(":Please rate"), contains(":Â Please rate"), contains(":If it applies to you, please rate"), contains(":Â   Please estimate"), names(sss21)[138:152])
names(sss21.slct) [1]<-"pc_id"
names(sss21.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss21.slct))
names(sss21.slct)
#revert to data frame to make variables and detect values for each variable
df_sss21<-as.data.frame(sss21.slct)
str(df_sss21)
names(df_sss21)
rm(sss21.slct)
rm(sss21)
#======merge 2021 student background data========
#-----------datamart file-----------------------
#read file
datamart21<- read_excel("Datamart21Fall.xlsx")
names(datamart21)
#select variables
df_datamart21 <- datamart21 %>% select (PC_ID, GENDER_CODE, ETHNICITY_REPORT_DESC, ADMIT_REGION, CITIZENSHIP, RESIDENT_YN, PARENTS_DEGREE, ADMIT_TYPE, TRANSFER_YN, COHORT, CLASS_LEVEL_RPT_LABEL, ACADEMIC_DEPT, CIP_CATEGORY, MAJOR_1, REG_PRIOR_CUM_GPA) %>% as.data.frame() #check
names(df_datamart21)<- tolower(names(df_datamart21))
# merge with data mart
df_sss21_full<-left_join(df_sss21,df_datamart21,by.x = "pc_id", by.y = "pc_id")
#check
ncol(df_sss21_full)
ncol(df_sss21)
#--------------registar data-----------
#read data
reg21<- read_excel("Registar21Fall.xlsx")
names(reg21)
#select variables
df_reg21 <- reg21 %>% select (CumGPA, `FT/PT`, `People Code Id`) %>% as.data.frame()
names(df_reg21)[3] <- "pc_id"
names(df_reg21)<- tolower(names(df_reg21))
# merge with registar data
df_sss21_full<-left_join(df_sss21_full,df_reg21, by = "pc_id")
#check
ncol(df_sss21_full)
ncol(df_sss21)
#remove unnecessary objects
rm(datamart21, df_datamart21, reg21, df_reg21, df_sss21)
#========merge historical data========
setwd("~/Documents/Rprojects/student_satisfaction_survey")
list.files()
source("sss_17-20_matched.R")  #run code from saved r script
#========save merged main files =====
#write_xlsx(df_sss21_full,"sss21_full.xlsx")
#write_xlsx(sss21.qual,"sss21_qual.xlsx")
#write_xlsx(df_sss_history,"sss17-20_matched.xlsx")
#save data in one excel
require(openxlsx)
list_of_datasets <- list("data_21quan" = df_sss21_full, "data_21qual" = sss21.qual, "data_17"=sss17.slct2, "data_18"=sss18.slct2, "data_19"=sss19.slct2, "data_20"=sss20.slct2)
write.xlsx(list_of_datasets, file = "fulldata.xlsx")
#check
list.files()
read_excel("fulldata.xlsx", sheet = "data_21quan")
read_excel("fulldata.xlsx", sheet = "data_21qual")
read_excel("fulldata.xlsx", sheet = "data_17")
read_excel("fulldata.xlsx", sheet = "data_18")
read_excel("fulldata.xlsx", sheet = "data_19")
read_excel("fulldata.xlsx", sheet = "data_20")
sss21<-read_excel("2021 SSS Raw.xlsx")
names(sss21)
#glimpse(sss21$`Invite Custom Field 1`)
#select (and rename) variables to build separate data frames
#create the main data file (qualitative)
sss21.qual<-select(sss21, starts_with("Please explain"), starts_with("Please provide explanations"), starts_with("Please provide any additional details"), names(sss21)[153])
names(sss21.qual)
#select variables to create the main quantitative data file
sss21.slct<-sss21 %>% select(`Invite Custom Field 1`,  `Which of the following describes your status for the 2021 fall semester?`, contains(":Please rate"), contains(":Â Please rate"), contains(":If it applies to you, please rate"), contains(":Â   Please estimate"), names(sss21)[138:152])
names(sss21.slct) [1]<-"pc_id"
names(sss21.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss21.slct))
names(sss21.slct)
df_sss21<-as.data.frame(sss21.slct)
str(df_sss21)
names(df_sss21)
rm(sss21.slct)
rm(sss21)
datamart21<- read_excel("Datamart21Fall.xlsx")
names(datamart21)
#select variables
df_datamart21 <- datamart21 %>% select (PC_ID, GENDER_CODE, ETHNICITY_REPORT_DESC, ADMIT_REGION, CITIZENSHIP, RESIDENT_YN, PARENTS_DEGREE, ADMIT_TYPE, TRANSFER_YN, COHORT, CLASS_LEVEL_RPT_LABEL, ACADEMIC_DEPT, CIP_CATEGORY, MAJOR_1, REG_PRIOR_CUM_GPA) %>% as.data.frame() #check
names(df_datamart21)<- tolower(names(df_datamart21))
# merge with data mart
df_sss21_full<-left_join(df_sss21,df_datamart21,by.x = "pc_id", by.y = "pc_id")
#check
ncol(df_sss21_full)
ncol(df_sss21)
names(df_sss21)
View(df_sss21)
View(datamart21)
names(df_datamart21)<- tolower(names(df_datamart21))
View(df_datamart21)
df_sss21_full<-left_join(df_sss21,df_datamart21,by = "pc_id")
rlang::last_error()
rlang::last_trace()
#working with df_sss21, to combine a few columns
df_sss21<- df_sss21 %>%
mutate(use_computer= if_else(df_sss21$names(df_sss21)[56]=="Other - Write In (Required)",df_sss21$names(df_sss21)[56],df_sss21$names(df_sss21)[57]))
#check
df_sss21 %>% group_by(df_sss21$names(df_sss21)[56]) %>% count()
df_sss21 %>% group_by(pc_id) %>% summarise(n_per_key=n()) %>% ungroup %>% count(n_per_key)
names(sss21.slct) [57]<-"Other_use_computer"
names(sss21.slct) [59]<-"Other_access_textbook"
names(sss21.slct)
sss21<-read_excel("2021 SSS Raw.xlsx")
names(sss21)
#glimpse(sss21$`Invite Custom Field 1`)
#select (and rename) variables to build separate data frames
#
#create the main data file (qualitative)
sss21.qual<-select(sss21, starts_with("Please explain"), starts_with("Please provide explanations"), starts_with("Please provide any additional details"), names(sss21)[153])
names(sss21.qual)
#select variables to create the main quantitative data file
sss21.slct<-sss21 %>% select(`Invite Custom Field 1`,  `Which of the following describes your status for the 2021 fall semester?`, contains(":Please rate"), contains(":Â Please rate"), contains(":If it applies to you, please rate"), contains(":Â   Please estimate"), names(sss21)[138:152])
names(sss21.slct) [1]<-"pc_id"
names(sss21.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss21.slct))
names(sss21.slct) [57]<-"Other_use_computer"
names(sss21.slct) [59]<-"Other_access_textbook"
names(sss21.slct)
#revert to data frame to make variables and detect values for each variable
df_sss21<-as.data.frame(sss21.slct)
str(df_sss21)
names(df_sss21)
rm(sss21.slct)
rm(sss21)
df_sss21 %>% group_by(pc_id) %>% summarise(n_per_key=n()) %>% ungroup %>% count(n_per_key)
#------------load package--------------
library(readxl) #for read_excel
library(readr) #for read_csv
library(dplyr) #for select, rename, join, etc.
library(tidyverse) #for pipes
library(ggplot2) #for making charts
library(stringr)  #for working with strings/texts/qualitative data
library("writexl")#for save data frame as excel files
#------working directory --------
getwd()
setwd("-/Documents/Rprojects/data/student_satisfaction_survey")
#============data files ===========
#------main data file--------------
#read data files, initial exploration
sss21<-read_excel("2021 SSS Raw.xlsx")
names(sss21)
#glimpse(sss21$`Invite Custom Field 1`)
#select (and rename) variables to build separate data frames
#
#create the main data file (qualitative)
sss21.qual<-select(sss21, starts_with("Please explain"), starts_with("Please provide explanations"), starts_with("Please provide any additional details"), names(sss21)[153])
names(sss21.qual)
#select variables to create the main quantitative data file
sss21.slct<-sss21 %>% select(`Invite Custom Field 1`,  `Which of the following describes your status for the 2021 fall semester?`, contains(":Please rate"), contains(":Â Please rate"), contains(":If it applies to you, please rate"), contains(":Â   Please estimate"), names(sss21)[138:152])
names(sss21.slct) [1]<-"pc_id"
names(sss21.slct)<- gsub(":[A-Za-z]*.*$", "", names(sss21.slct))
names(sss21.slct) [57]<-"Other_use_computer"
names(sss21.slct) [59]<-"Other_access_textbook"
names(sss21.slct)
#revert to data frame to make variables and detect values for each variable
df_sss21<-as.data.frame(sss21.slct)
str(df_sss21)
names(df_sss21)
rm(sss21.slct)
rm(sss21)
#======merge 2021 student background data========
#check primary key
df_sss21 %>% group_by(pc_id) %>% summarise(n_per_key=n()) %>% ungroup %>% count(n_per_key)
#-----------datamart file-----------------------
#read file
datamart21<- read_excel("Datamart21Fall.xlsx")
names(datamart21)
#select variables
df_datamart21 <- datamart21 %>% select (PC_ID, GENDER_CODE, ETHNICITY_REPORT_DESC, ADMIT_REGION, CITIZENSHIP, RESIDENT_YN, PARENTS_DEGREE, ADMIT_TYPE, TRANSFER_YN, COHORT, CLASS_LEVEL_RPT_LABEL, ACADEMIC_DEPT, CIP_CATEGORY, MAJOR_1, REG_PRIOR_CUM_GPA) %>% as.data.frame() #check
names(df_datamart21)<- tolower(names(df_datamart21))
# merge with data mart
df_sss21_full<-left_join(df_sss21,df_datamart21,by = "pc_id")
#check
ncol(df_sss21_full)
ncol(df_sss21)
#--------------registar data-----------
#read data
reg21<- read_excel("Registar21Fall.xlsx")
names(reg21)
#select variables
df_reg21 <- reg21 %>% select (CumGPA, `FT/PT`, `People Code Id`) %>% as.data.frame()
names(df_reg21)[3] <- "pc_id"
names(df_reg21)<- tolower(names(df_reg21))
# merge with registar data
df_sss21_full<-left_join(df_sss21_full,df_reg21, by = "pc_id")
#check
ncol(df_sss21_full)
ncol(df_sss21)
#remove unnecessary objects
rm(datamart21, df_datamart21, reg21, df_reg21, df_sss21)
#========merge historical data========
setwd("~/Documents/Rprojects/student_satisfaction_survey")
list.files()
source("sss_17-20_matched.R")  #run code from saved r script
#========save merged main files =====
#write_xlsx(df_sss21_full,"sss21_full.xlsx")
#write_xlsx(sss21.qual,"sss21_qual.xlsx")
#write_xlsx(df_sss_history,"sss17-20_matched.xlsx")
#save data in one excel
require(openxlsx)
list_of_datasets <- list("data_21quan" = df_sss21_full, "data_21qual" = sss21.qual, "data_17"=sss17.slct2, "data_18"=sss18.slct2, "data_19"=sss19.slct2, "data_20"=sss20.slct2)
write.xlsx(list_of_datasets, file = "fulldata.xlsx")
#check
list.files()
read_excel("fulldata.xlsx", sheet = "data_21quan")
read_excel("fulldata.xlsx", sheet = "data_21qual")
read_excel("fulldata.xlsx", sheet = "data_17")
read_excel("fulldata.xlsx", sheet = "data_18")
read_excel("fulldata.xlsx", sheet = "data_19")
read_excel("fulldata.xlsx", sheet = "data_20")
